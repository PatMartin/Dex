<!DOCTYPE html>
<meta charset="utf-8">
<style>
  html, body {
    height: 100%;
    min-height: 100%;
    width: 100%;
    min-width: 100%;
  }

  .axis path,
  .axis line {
    fill: none;
    stroke: #000;
    shape-rendering: crispEdges;
  }

  #HeatmapArea {
    width: 100%;
    height: 100%;
  }

</style>
<body>
<svg id="HeatmapArea"></svg>
<script>
<%
  println new File("javascript/d3/latest/d3.min.js").text
  println new File("C:/WS/DexCharts/dex.js").text
  println new File("C:/WS/DexCharts/js/dex/component/d3/HeatMap.js").text
  println new File("C:/WS/DexCharts/js/dex/component/d3/VerticalLegend.js").text
%>
</script>

<script>

  var csv =
  {
    'header' : ["date", "bucket", "count"],
    'data'   : [
      ["7/20/2012", "800", "119"],
      ["7/20/2012", "900", "123"],
      ["7/20/2012", "1000", "173"],
      ["7/20/2012", "1100", "226"],
      ["7/20/2012", "1200", "284"],
      ["7/20/2012", "1300", "257"],
      ["7/20/2012", "1400", "268"],
      ["7/20/2012", "1500", "244"],
      ["7/20/2012", "1600", "191"],
      ["7/20/2012", "1700", "204"],
      ["7/20/2012", "1800", "187"],
      ["7/20/2012", "1900", "177"],
      ["7/20/2012", "2000", "164"],
      ["7/20/2012", "2100", "125"],
      ["7/20/2012", "2200", "140"],
      ["7/20/2012", "2300", "109"],
      ["7/20/2012", "2400", "103"],
      ["7/21/2012", "800", "123"],
      ["7/21/2012", "900", "165"],
      ["7/21/2012", "1000", "237"],
      ["7/21/2012", "1100", "278"],
      ["7/21/2012", "1200", "338"],
      ["7/21/2012", "1300", "306"],
      ["7/21/2012", "1400", "316"],
      ["7/21/2012", "1500", "269"],
      ["7/21/2012", "1600", "271"],
      ["7/21/2012", "1700", "241"],
      ["7/21/2012", "1800", "188"],
      ["7/21/2012", "1900", "174"],
      ["7/21/2012", "2000", "158"],
      ["7/21/2012", "2100", "153"],
      ["7/21/2012", "2200", "132"],
      ["7/22/2012", "900", "154"],
      ["7/22/2012", "1000", "241"],
      ["7/22/2012", "1100", "246"],
      ["7/22/2012", "1200", "300"],
      ["7/22/2012", "1300", "305"],
      ["7/22/2012", "1400", "301"],
      ["7/22/2012", "1500", "292"],
      ["7/22/2012", "1600", "253"],
      ["7/22/2012", "1700", "251"],
      ["7/22/2012", "1800", "214"],
      ["7/22/2012", "1900", "189"],
      ["7/22/2012", "2000", "179"],
      ["7/22/2012", "2100", "159"],
      ["7/22/2012", "2200", "161"],
      ["7/22/2012", "2300", "144"],
      ["7/22/2012", "2400", "139"],
      ["7/22/2012", "2500", "132"],
      ["7/22/2012", "2600", "136"],
      ["7/22/2012", "2800", "105"],
      ["7/23/2012", "800", "120"],
      ["7/23/2012", "900", "156"],
      ["7/23/2012", "1000", "209"],
      ["7/23/2012", "1100", "267"],
      ["7/23/2012", "1200", "299"],
      ["7/23/2012", "1300", "316"],
      ["7/23/2012", "1400", "318"],
      ["7/23/2012", "1500", "307"],
      ["7/23/2012", "1600", "295"],
      ["7/23/2012", "1700", "273"],
      ["7/23/2012", "1800", "283"],
      ["7/23/2012", "1900", "229"],
      ["7/23/2012", "2000", "192"],
      ["7/23/2012", "2100", "193"],
      ["7/23/2012", "2200", "170"],
      ["7/23/2012", "2300", "164"],
      ["7/23/2012", "2400", "154"],
      ["7/23/2012", "2500", "138"],
      ["7/23/2012", "2600", "101"],
      ["7/23/2012", "2700", "115"],
      ["7/23/2012", "2800", "103"],
      ["7/24/2012", "800", "105"],
      ["7/24/2012", "900", "156"],
      ["7/24/2012", "1000", "220"],
      ["7/24/2012", "1100", "255"],
      ["7/24/2012", "1200", "308"],
      ["7/24/2012", "1300", "338"],
      ["7/24/2012", "1400", "318"],
      ["7/24/2012", "1500", "255"],
      ["7/24/2012", "1600", "278"],
      ["7/24/2012", "1700", "260"],
      ["7/24/2012", "1800", "235"],
      ["7/24/2012", "1900", "230"],
      ["7/24/2012", "2000", "185"],
      ["7/24/2012", "2100", "145"],
      ["7/24/2012", "2200", "147"],
      ["7/24/2012", "2300", "157"],
      ["7/24/2012", "2400", "109"],
      ["7/25/2012", "800", "104"],
      ["7/25/2012", "900", "191"],
      ["7/25/2012", "1000", "201"],
      ["7/25/2012", "1100", "238"],
      ["7/25/2012", "1200", "223"],
      ["7/25/2012", "1300", "229"],
      ["7/25/2012", "1400", "286"],
      ["7/25/2012", "1500", "256"],
      ["7/25/2012", "1600", "240"],
      ["7/25/2012", "1700", "233"],
      ["7/25/2012", "1800", "202"],
      ["7/25/2012", "1900", "180"],
      ["7/25/2012", "2000", "184"],
      ["7/25/2012", "2100", "161"],
      ["7/25/2012", "2200", "125"],
      ["7/25/2012", "2300", "110"],
      ["7/25/2012", "2400", "101"],
      ["7/26/2012", "1300", "132"],
      ["7/26/2012", "1400", "117"],
      ["7/26/2012", "1500", "124"],
      ["7/26/2012", "1600", "154"],
      ["7/26/2012", "1700", "167"],
      ["7/26/2012", "1800", "137"],
      ["7/26/2012", "1900", "169"],
      ["7/26/2012", "2000", "175"],
      ["7/26/2012", "2100", "168"],
      ["7/26/2012", "2200", "188"],
      ["7/26/2012", "2300", "137"],
      ["7/26/2012", "2400", "173"],
      ["7/26/2012", "2500", "164"],
      ["7/26/2012", "2600", "167"],
      ["7/26/2012", "2700", "115"],
      ["7/26/2012", "2800", "116"],
      ["7/26/2012", "2900", "118"],
      ["7/26/2012", "3000", "125"],
      ["7/26/2012", "3200", "104"]
    ]
  };

  // Convert the strings to dates.
  csv.data.map(function (row) {
    dex.console.log("ROW:", row);
    var parts = row[0].match(/(\\d+)/g);
    row[0] = new Date(parts[2], parts[0]-1,parts[1]);
  });

  var heatmap = new HeatMap({
        'parent'                : "#HeatmapArea",
        'csv'                   : csv,
        'transform'             : 'scale(0.8)translate(100 0)',
        //'xaxis.scale.domain' : [ new Date(2012, 7, 20), new Date(2012, 7, 26)],
        'xaxis.scale.type'      : 'time',
        'heat.scale.range'      : ['red', 'blue'],
        'xaxis.tickFormat'      : d3.time.format("%m/%d"),
        'xaxis.ticks'           : 6,
        'xaxis.label.text'      : 'Day',
        //'xaxis.label.transform' : 'translate(400, 100)',
        'yaxis.label.text'      : 'Count'
        //'yaxis.label.transform' : 'translate(-60,270) rotate(-90)'
      }
  );

  heatmap.render();

</script>
</body>
</html>